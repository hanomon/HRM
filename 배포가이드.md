# 🚀 배포 가이드

백엔드와 프론트엔드를 한번에 배포하는 가장 쉬운 방법입니다.

## 📌 추천 방법: Railway 사용

Railway를 사용하면 **한 곳에서** 백엔드와 프론트엔드를 모두 관리할 수 있습니다.

### 장점
- ✅ 가장 쉬움 (클릭 몇 번으로 완료)
- ✅ 백엔드 + 프론트엔드 한번에 배포
- ✅ GitHub 자동 연동 (푸시하면 자동 배포)
- ✅ 무료 ($5 크레딧/월 제공)
- ✅ 항상 켜져있음 (슬립 모드 없음)

---

## 🎯 Railway 배포 시작하기

### 1단계: 회원가입 (1분)

1. **https://railway.app** 접속
2. 우측 상단 **"Login"** 클릭
3. **"Login with GitHub"** 선택
4. GitHub 계정으로 로그인
5. Railway 권한 승인

### 2단계: 새 프로젝트 만들기 (1분)

1. 대시보드에서 **"New Project"** 클릭
2. **"Deploy from GitHub repo"** 선택
3. **"Configure GitHub App"** 클릭
   - Railway가 GitHub 저장소에 접근할 수 있도록 권한 부여
4. 저장소 목록에서 **"hanomon/HRM"** 선택
5. **"Deploy Now"** 클릭

### 3단계: 백엔드 서비스 설정 (2분)

Railway가 자동으로 프로젝트를 감지합니다.

**서비스 이름 확인:**
- 프로젝트가 생성되면 서비스가 자동으로 시작됨
- 서비스를 클릭해서 상세 설정으로 이동

**Settings 탭에서 설정:**

```
Service Name: backend (원하는 이름으로 변경 가능)
Root Directory: backend
Build Command: npm install && npm run build
Start Command: npm start
Watch Paths: backend/**
```

**Variables 탭에서 환경변수 추가:**

1. **"+ New Variable"** 클릭
2. 다음 환경변수 추가:

```
NODE_ENV = production
DATABASE_PATH = ./attendance.db
```

3. **"Deploy"** 클릭

**URL 확인:**
- 배포가 완료되면 **Settings → Networking** 에서 URL 확인
- 예: `https://hrm-backend-production.up.railway.app`
- **이 URL을 복사해두세요!** 📋

### 4단계: 프론트엔드 서비스 추가 (2분)

1. 프로젝트 대시보드로 돌아가기
2. **"+ New"** 버튼 클릭
3. **"GitHub Repo"** 선택
4. 같은 저장소 **"hanomon/HRM"** 선택

**Settings 탭에서 설정:**

```
Service Name: frontend (원하는 이름으로 변경 가능)
Root Directory: frontend
Build Command: npm install && npm run build
Start Command: npm run preview -- --port $PORT --host 0.0.0.0
Watch Paths: frontend/**
```

**Variables 탭에서 환경변수 추가:**

1. **"+ New Variable"** 클릭
2. 다음 환경변수 추가:

```
VITE_API_URL = https://hrm-backend-production.up.railway.app/api
```

⚠️ **주의**: 위의 URL을 3단계에서 복사한 백엔드 URL로 바꾸고 끝에 `/api`를 추가하세요!

3. **"Deploy"** 클릭

### 5단계: 배포 완료! 🎉

**배포된 URL 확인:**

- **백엔드**: `https://hrm-backend-production.up.railway.app`
- **프론트엔드**: `https://hrm-frontend-production.up.railway.app`

**프론트엔드 URL로 접속해보세요!**

---

## 🌱 초기 데이터 추가하기

빈 데이터베이스에 테스트 직원과 출퇴근 기록을 추가합니다.

### 방법

1. Railway 대시보드에서 **백엔드 서비스** 클릭
2. 상단 탭에서 **"Shell"** 클릭
3. 터미널이 열리면 다음 명령어 입력:

```bash
npm run seed -- --force
```

4. 엔터 키를 누르면 데이터 생성됨:
   - 직원 3명 (김철수, 이영희, 박민수)
   - 출퇴근 기록 45건 (최근 7일)

5. 프론트엔드를 새로고침하면 데이터가 보입니다!

---

## 🔄 자동 배포 설정

이미 완료! 🎉

이제 코드를 수정하고 GitHub에 푸시하면:

```bash
git add .
git commit -m "기능 추가"
git push origin main
```

Railway가 자동으로:
1. 변경사항 감지
2. 백엔드와 프론트엔드 자동 빌드
3. 자동 배포

---

## 💰 비용

**Railway 무료 플랜:**
- 매달 $5 무료 크레딧 제공
- 예상 사용량: 약 $3-4/월
- **무료 범위 내에서 충분히 사용 가능!**

**업그레이드가 필요한 경우:**
- Hobby 플랜: $5/월부터
- 더 많은 리소스와 기능 제공

---

## 🎨 추가 설정 (선택사항)

### 커스텀 도메인 연결

**Settings → Networking → Custom Domain:**

```
백엔드: api.yourdomain.com
프론트엔드: yourdomain.com
```

### 데이터 영구 저장 (중요!)

Railway는 기본적으로 디스크를 제공하지만, 더 안전하게 하려면:

1. 백엔드 서비스 → **"Settings"**
2. **"Volumes"** 섹션 찾기
3. **"+ Add Volume"** 클릭
4. **Mount Path**: `/app/data`
5. 환경변수 변경: `DATABASE_PATH=/app/data/attendance.db`

---

## 🐛 문제 해결

### 백엔드 연결 안 됨

**증상**: 프론트엔드에서 데이터가 로드되지 않음

**해결 방법:**

1. 백엔드 URL이 올바른지 확인
2. 프론트엔드 환경변수에서 `VITE_API_URL` 확인
3. URL 끝에 `/api`가 있는지 확인
4. 백엔드 서비스의 **"Logs"** 탭에서 에러 확인

### 빌드 실패

**해결 방법:**

1. Railway의 **"Deployments"** 탭에서 에러 로그 확인
2. 로컬에서 테스트:
```bash
cd backend
npm run build

cd ../frontend
npm run build
```

### 데이터가 사라짐

**원인**: Volume이 설정되지 않음

**해결**: 위의 "데이터 영구 저장" 섹션 참고

---

## 📊 모니터링

Railway 대시보드에서:

- **Metrics**: CPU, 메모리, 네트워크 사용량 확인
- **Logs**: 실시간 서버 로그 확인
- **Deployments**: 배포 히스토리 확인

---

## ✅ 배포 완료 체크리스트

배포가 끝났다면 다음을 확인하세요:

- [ ] 백엔드 URL 접속 확인
- [ ] 프론트엔드 URL 접속 확인
- [ ] 직원 관리 페이지 작동 확인
- [ ] 출퇴근 기록 조회 확인
- [ ] Excel 내보내기 작동 확인
- [ ] 테스트 데이터 추가 완료
- [ ] 팀원들에게 URL 공유

---

## 🎯 다음 단계

배포가 완료되었습니다! 이제:

1. **팀원들에게 URL 공유**
2. **Android 태블릿에서 프론트엔드 URL 접속**
3. **NFC 태깅 페이지에서 실제 카드로 테스트**
4. **실제 직원 데이터 입력**
5. **피드백 수집 및 개선**

---

## 📞 도움이 필요하신가요?

- 🐛 버그 리포트: GitHub Issues
- 💬 질문: GitHub Discussions
- 📖 더 자세한 가이드: [docs/DEPLOY_RAILWAY.md](docs/DEPLOY_RAILWAY.md)

---

## 🎉 축하합니다!

HRM 시스템이 전 세계 어디서나 접속 가능하게 되었습니다!

**배포 완료 시간**: 약 5-10분  
**난이도**: ⭐⭐☆☆☆  
**비용**: 무료 (Railway $5 크레딧 내)

